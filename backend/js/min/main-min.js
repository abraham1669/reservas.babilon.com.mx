$(document).ready(function(){$("input, textarea").keyup(function(){return""!==$(this).val()?($(this).removeClass("error"),!1):void 0}),$("select").change(function(){""!==$(this).val()&&$(this).removeClass("error")}),$("body").append('<div id="ajaxBusy"><div class="overlay"></div><img src="'+$url+'img/wait.gif"><br/><p>Espere por favor...</p></div>'),$("#ajaxBusy").css({height:$(document).height()})});var ajaxWorking,armalostelefonos,categoriaSelect,displayError,drawTelephones,fromLogin,invisible,logoupload,reloadData,reloadList,reloadModel,salvarAction,urlsafe,visible,__indexOf=[].indexOf||function(e){for(var a=0,t=this.length;t>a;a++)if(a in this&&this[a]===e)return a;return-1};fromLogin=function(){return location.reload()},ajaxWorking=function(e){return $("body").append($("<div/>",{id:"ajaxBusy"}).append($("<div/>",{"class":"conte"}).append($("<img/>",{src:$url+"public/images/layout/loading.gif"})),$("<div/>",{"class":"ui-widget-overlay"}))),$("#ajaxBusy").css({display:"table",position:"fixed",top:"0px",left:"0px",height:$(window).height(),width:$(window).width(),textAlign:"center"}),$("#ajaxBusy .conte").css({position:"relative",display:"table-cell","vertical-align":"middle"}),$("#ajaxBusy img").css({"vertical-align":"middle"})},logoupload=function(e){return $("#ajaxBusy").remove(),"Ok"===e.Estatus?($("#"+e.reload).attr({src:$url+e.Path}),$("#"+e.reload+"Input").val(e.Path)):($("#errorHandle").html(e.Desc),$("#errorHandle").dialog({modal:!0,title:"Error",buttons:{Cerrar:function(){return $(this).dialog("close")}}}))},visible=function(e){return e.css({visibility:"visible"}),e.animate({opacity:1},0)},invisible=function(e){return e.css({visibility:""}),e.animate({opacity:0},0)},displayError=function(e,a){return $(".errorHandle div").removeClass("alert-danger, alert-warning").addClass(a).text(e),$(".errorHandle").fadeIn(function(){var e;return e=setTimeout(function(){return $(".errorHandle").fadeOut(500)},2e3)})},salvarAction=function(e){var a,t,n,o,r,i;o={},a={},t=!1,r="",e.closest("section").find("input, select, textarea").each(function(){var e;return""===$(this).val()&&$(this).hasClass("required")&&(t=!0,r="Todos los campos marcados son requeridos"),e=$(this).attr("name"),void(null!=o[e]?(null==a[e]&&(a[e]=[]),"checkbox"===$(this).attr("type")?$(this).is(":checked")&&a[e].push($(this).val()):a[e].push($(this).val()),"placeholder"!==o[e]&&(a[e].unshift(o[e]),o[e]="placeholder")):"checkbox"===$(this).attr("type")?$(this).is(":checked")&&(o[e]=$(this).val()):o[e]=$(this).val())}),void 0!==o.Remail&&o.Email!==o.Remail&&(t=!0,r="El email y la confirmación no coinciden"),"-1"===o.ID&&""===o.Password&&(t=!0,r="La contraseña es requerida");for(n in a)i=a[n],o[n]=i.join(",");return t?displayError(r,"alert-danger"):$.post($url+e.data("action"),o,function(e){return e=JSON.parse(e),"Ok"!==e.estado?displayError(e.mensaje,"alert-warning"):(window.onbeforeunload=null,location.reload())})},urlsafe=function(e){var a;return a=e.replace(/[ñ]/gi,"n"),a=a.replace(/[âäáàã]/gi,"a"),a=a.replace(/[êëéè]/gi,"e"),a=a.replace(/[îïíì]/gi,"i"),a=a.replace(/[ôöóòõ]/gi,"o"),a=a.replace(/[ûüúù]/gi,"u"),a=a.replace(/[^a-z0-9]/gi,"-").toLowerCase(),"-"===a.substring(a.length-1)&&(a=a.substring(0,a.length-1)),a},categoriaSelect=function(e){var a;return a=e.data("modelo"),$.post($url+e.data("datos"),{Categoria:e.val(),Negocio:a},function(e){var a,t,n,o,r,i,l,s,u;for(a=JSON.parse(e),n=a.tags,o=a.bistags,$(".lasetiquetas").html(""),u=[],i=0,l=n.length;l>i;i++)t=n[i],r={type:"checkbox",value:t.ID,name:"Tags"},s=t.ID,__indexOf.call(o,s)>=0&&(r.checked=!0),u.push($(".lasetiquetas").append($("<label/>",{"class":"etiquetas"}).append(t.Nombre_es,$("<input/>",r))));return u})},drawTelephones=function(e){var a,t,n,o,r,i,l,s;for(t=function(e,a){return e.Tipo<a.Tipo?-1:e.Tipo>a.Tipo?1:0},e.sort(t),$("#telefonosField").val(JSON.stringify(e)),e.unshift({Tipo:"",Value:""}),o=$("#telefonosDiv"),o.html(""),s=[],i=0,l=e.length;l>i;i++)r=e[i],n=$("<div/>",{"class":"delTelephone"}).append($("<div/>",{"class":"utilicons-white utilicons-borrar"})),a=$("<div/>",{"class":"addTelephone"}).append($("<div/>",{"class":"utilicons-white utilicons-plus"})),""!==r.Value&&(a=!1),""===r.Value&&(n=!1),s.push(o.append($("<div/>",{"class":"telefono"}).append($("<input/>",{name:"telefonoType","class":"tipo",placeholder:"Oficina",value:r.Tipo}),$("<input/>",{name:"telefonoValue","class":"valor",placeholder:"(442) 000-0000",value:r.Value}),a,n)));return s},armalostelefonos=function(){var e;return e=[],$("#telefonosDiv .telefono").each(function(){var a;a={Tipo:$(this).children(".tipo").val(),Value:$(this).children(".valor").val()},""!==a.Value&&""!==a.Tipo&&e.push(a)}),drawTelephones(e)},reloadData=function(e,a,t){return null==t&&(t=!1),$(e.data("reload")).fadeOut(function(){return $(e.data("reload")).html(a).fadeIn(),t!==!1?t():void 0})},reloadList=function(e,a){return null==a&&(a=!1),$.post($url+e.data("datos"),function(t){return reloadData(e,t,a)})},reloadModel=function(e,a){return null==a&&(a=!1),$.post($url+e.data("datos"),{ID:e.data("item")},function(t){return reloadData(e,t,a)})},window.onbeforeunload=function(){var e,a,t,n;return;if($(".activeModel").length>0)for(n=$('.activeModel input[type="text"]'),a=0,t=n.length;t>a;a++)if(e=n[a],""!==e.value){return"Usted tiene cambios sin guardar, desea descartarlos?";break}},$(".layout header").on("click",".menuHandle",function(){return $(".layout header .menuholder .menuBody").toggle()}).on("click",".perfilHandle",function(){return $(".layout header .perfilholder .perfilBody").toggle()}).on("mouseenter",".menuholder",function(){return $(".layout header .menuholder .menuBody").show(),visible($(".layout header .menuholder .menuBody"))}).on("mouseleave",".menuholder",function(){return invisible($(".layout header .menuholder .menuBody"))}).on("mouseenter",".perfilholder",function(){return $(".layout header .perfilholder .perfilBody").show(),visible($(".layout header .perfilholder .perfilBody"))}).on("mouseleave",".perfilholder",function(){return invisible($(".layout header .perfilholder .perfilBody"))}),$(".createBton a").click(function(){var e;return e=$(this),reloadModel(e,function(){return $(".listando, .editando").toggle(),categoriaSelect($("#categoriaSelect"))})}),$(".saveBton a").click(function(){return salvarAction($(this))}),$(".activeDiv").on("click",".activeModel .addTelephone",function(){return armalostelefonos()}).on("click",".activeModel .delTelephone",function(){return $(this).parent().remove(),armalostelefonos()}).on("click",".activeModel .salvarBton a",function(){return salvarAction($(this))}).on("keyup",".activeModel .generaURL",function(){var e,a;return e=$(this),a=urlsafe(e.val()),$(e.data("urlfield")).val(a)}).on("change",".activeModel .soyurl",function(){var e,a;return e=$(this),a=urlsafe(e.val()),e.val(a)}).on("click",".eliminaElemento",function(){var e;return e=$(this),confirm("Confirme eliminación")?$.post($url+e.data("action"),{ID:e.data("item")},function(){return location.reload()}):void 0}).on("click",".editarElemento",function(){var e;return e=$(this),reloadModel(e)}).on("click",".editarElemento2",function(){var e;return e=$(this),reloadModel(e,function(){return $(".listando, .editando").toggle(),categoriaSelect($("#categoriaSelect"))})}).on("click",".setPage",function(){var e;return e=$(this),$.post($url+"es/backend/"+e.data("modelo")+"/paginacion",{pagina:e.data("pagina")},function(){return reloadList(e)})}).on("click",".orden",function(){var e;return e=$(this),$.post($url+"es/backend/"+e.data("modelo")+"/ordenamiento",{orden:e.data("orden")},function(){return reloadList(e)})});